<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="com.class_ic.dao.BoardDAO">


<insert id="insertBoardContent" parameterType="com.class_ic.vo.LectureBoardDTO">
insert into lectureboard(classCode,cateCode,subcateCode,lectureTitle,lectureContent,lectureDate)
values(#{classCode},#{cateCode},#{subcateCode},#{lectureTitle},#{lectureContent},CURDATE())
</insert>

<select id="selectCategory" resultType="com.class_ic.vo.CategoryDTO">
select * from category
</select>

<select id="selectSubCategory" resultType="com.class_ic.vo.SubCategoryDTO">
select * from subcategory
</select>

<!-- LectureBoard 추가부분 -->

<!-- 통합게시판 화면 출력 -->
 <select id="allBoard" resultType="com.class_ic.vo.LectureBoardDTO" parameterType="String">
    select * from lectureboard where cateCode=#{param1} and subcateCode=#{param2} 
 </select> 
 
<!--통합게시판 수정화면 출력   --> 
<select id="totalboardEdit" resultType="com.class_ic.vo.LectureBoardDTO" parameterType="int">
   select * from lectureboard where lectureNo=#{lectureNo}
</select>

<!--통합게시판 상세보기 화면 출력   --> 
<select id="totalBoard_contentview" resultType="com.class_ic.vo.LectureBoardDTO"
      parameterType="int"> 
      select * from (select b.lectureContent lectureContent ,b.lectureDate lectureDate,b.lectureNo lectureNo ,b.lectureTitle lectureTitle,l.linkNo linkNo,l.linkTitle linkTitle, l.linkSrc  linkSrc,f.fileNo fileNo, f.lectureFileNo lectureFileNo,a.fileSrc fileSrc  
      from lectureboard b, link l , lectureboardfile f  , file a
      where l.lectureno =b.lectureno and b.lectureno= f.lectureno and f.fileno = a.fileno ) lectureboardcontent where lectureno = #{lectureNo}
</select>

<!-- 통합게시판 수정 완료 -->
<update id="totalboardEditOk" parameterType="com.class_ic.vo.LectureBoardDTO">
	update lectureboard set lectureTitle=#{lectureTitle}, lectureContent=#{lectureContent} where lectureNo=#{lectureNo}
</update>

<!--통합게시판 삭제 -->
<delete id="deleteLect" parameterType="Integer">
   delete from lectureboard where lectureNo=#{lectureNo}
</delete>

<!--  -->
<select id="allList" resultType="com.class_ic.vo.LectureBoardDTO" >
select * from lectureboard

</select>

<!-- 파일 추가 부분  -->

<!-- 통합게시판 자료 입력 -->
<insert id="insertFile">
	INSERT INTO file (fileSrc, fileSrc2)values(#{fileSrc}, #{fileSrc2});
</insert>
<!-- 통합게시판 자료 게시판 잇는 테이블 insert -->
<insert id="insertLectureBoardFile">
	INSERT INTO lectureboardfile (fileNo, lectureNo) VALUES (LAST_INSERT_ID(), LAST_INSERT_ID())
</insert>

<!-- 멤버 select box 출력 -->
<select id="selectMember" resultType="com.class_ic.vo.MemberDTO" parameterType="String">
select classCode from classmember where email=#{email};
</select>

<!-- 통합게시판 글 기수로 보내기 -->
<insert id="boardMultiSend" parameterType="com.class_ic.vo.ClassByLectureDTO">
insert into classbylecture values(#{lectureNo},#{classCode})
</insert>


<select id="selectClassByLecture" resultType="com.class_ic.vo.ClassByLectureDTO">
select * from classbylecture
</select>
</mapper>
